import{r as y,b as Z,o as b,c as $,d as i,e as P,w as z,l as F,b5 as We,O as Oe,j as k,b6 as ue,n as T,b7 as X,h as V,b8 as da,b9 as ua,ba as Ze,bb as Ge,y as A,aO as Ye,_ as Xe,Q as L,W as oe,k as j,a as Ee,aQ as Q,X as qe,f as W,bc as va,bd as _a,be as fa,bf as ha,T as me,F as ce,A as be,bg as Be,z as pa,U as ma,R as ga,aw as ge,ap as Ke,bh as ya,C as ba,b3 as xa}from"./index-DHmhvhj-.js";import{u as xe}from"./financeStore-DvWK18w9.js";import{_ as Ae}from"./arrow-right-finance-Dbx55g6C.js";import{b as Re}from"./chartConfig-CDLjL_Xa.js";import{m as ee,t as wa,r as S,f as ka,g as Ca,v as $a,h as Je,i as q,A as Da,P as Qe,B as de,j as Ma,k as Sa,C as we,c as ke,d as Ce,p as $e,a as De,b as Me,l as Se}from"./index-DfXRlx06.js";import{u as Pe}from"./studentsStore-3qTeppch.js";const Pa={class:"v-finance__cards"},Fa={class:"v-finance__cards-list"},Va={class:"v-finance__cards-list-item finance-card styled-section"},Ia={class:"finance-card__top"},Ea={key:0,class:"finance-card__bottom"},Ba={class:"finance-card__value"},Aa={class:"v-finance__cards-list-item finance-card styled-section"},Ra={key:0,class:"finance-card__bottom"},Ha={class:"finance-card__value"},Ta={class:"v-finance__cards-list-item finance-card styled-section"},za={key:0,class:"finance-card__bottom"},Ua={class:"finance-card__value"},La={class:"v-finance__cards-list-item finance-card styled-section"},Na={key:0,class:"finance-card__bottom"},ja={class:"finance-card__value"},Wa={__name:"v-finance-cards",setup(e){const s=xe(),a=y(null),t=y(),l=y(),n=d=>{console.log("Зашли в выбор периода");const c=d[0].toISOString().slice(0,10),v=d[1].toISOString().slice(0,10);a.value=d,s.currentRange=[c,v],o(c,v)},r=async()=>{l.value=await da()},o=async(d,c)=>{t.value=await ua(d,c)},u=()=>{const d=Ze();a.value=d;const c=d[0].toISOString().slice(0,10),v=d[1].toISOString().slice(0,10);s.currentRange=[c,v],o(c,v)};return Z(()=>{r(),u()}),(d,c)=>(b(),$("div",Pa,[i("ul",Fa,[i("li",Va,[i("div",Ia,[c[2]||(c[2]=i("div",{class:"finance-card__subtitle"},"Доход",-1)),P(F(Oe),{modelValue:a.value,"onUpdate:modelValue":[c[0]||(c[0]=v=>a.value=v),n],locale:"ru-RU",clearable:!0,format:F(We),"action-buttons":["cancel","submit"],"cancel-text":"Отмена","select-text":"Выбрать",class:"range custom-datepicker",range:""},{"clear-icon":z(({clear:v})=>c[1]||(c[1]=[])),_:1},8,["modelValue","format"])]),t.value?(b(),$("div",Ea,[i("div",Ba,k(F(ue)(t.value.total_earnings))+" ₽",1),t.value.percentage_change_earnings?(b(),$("span",{key:0,class:T(["status",F(X)(t.value.percentage_change_earnings)])},k(t.value.percentage_change_earnings)+" % ",3)):V("",!0)])):V("",!0)]),i("li",Aa,[c[3]||(c[3]=i("div",{class:"finance-card__top"},[i("div",{class:"finance-card__subtitle"},"Средний чек")],-1)),t.value?(b(),$("div",Ra,[i("div",Ha,k(F(ue)(t.value.average_earnings_per_hour))+" ₽",1),t.value.percentage_change_average_earnings?(b(),$("span",{key:0,class:T(["status",F(X)(t.value.percentage_change_average_earnings)])},k(t.value.percentage_change_average_earnings)+" % ",3)):V("",!0)])):V("",!0)]),i("li",Ta,[c[4]||(c[4]=i("div",{class:"finance-card__top"},[i("div",{class:"finance-card__subtitle"},"Рабочих часов")],-1)),t.value?(b(),$("div",za,[i("div",Ua,k(t.value.total_hours),1),i("span",{class:T(["status",F(X)(t.value.percentage_change_hours)])},k(t.value.percentage_change_hours)+" % ",3)])):V("",!0)]),i("li",La,[c[5]||(c[5]=i("div",{class:"finance-card__top"},[i("div",{class:"finance-card__subtitle"},"Расходы")],-1)),t.value?(b(),$("div",Na,[i("div",ja,k(F(ue)(t.value.total_expenditures))+" ₽",1),i("span",{class:T(["status",F(X)(t.value.total_expenditures)])},k(t.value.total_expenditures)+" % ",3)])):V("",!0)])])]))}},He="data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M12.5%205L7.5%2010L12.5%2015'%20stroke='%23717680'%20stroke-width='1.66667'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",Te=localStorage.getItem("nightMode"),ze={responsive:!0,maintainAspectRatio:!1,layout:{padding:{top:30}},plugins:{legend:{display:!1},tooltip:{enabled:!1},datalabels:{color:Te?"rgba(255, 255, 255, .56)":"#717680",font:{weight:500,size:13},anchor:"end",align:"top",offset:5,formatter:e=>`${e.toLocaleString()} ₽`}},scales:{x:{grid:{display:!1,drawBorder:!1},ticks:{font:{family:"Inter",size:13,fontWeight:600},color:Te?"#FFFFFF":"#344055"},border:{display:!1}},y:{beginAtZero:!0,display:!1,grid:{display:!1,drawTicks:!1},ticks:{display:!1}}},elements:{bar:{borderWidth:0}}};/*!
 * chartjs-plugin-datalabels v2.2.0
 * https://chartjs-plugin-datalabels.netlify.app
 * (c) 2017-2022 chartjs-plugin-datalabels contributors
 * Released under the MIT license
 */var Ue=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var e=window.screen;if(e)return(e.deviceXDPI||1)/(e.logicalXDPI||1)}return 1}(),K={toTextLines:function(e){var s=[],a;for(e=[].concat(e);e.length;)a=e.pop(),typeof a=="string"?s.unshift.apply(s,a.split(`
`)):Array.isArray(a)?e.push.apply(e,a):q(e)||s.unshift(""+a);return s},textSize:function(e,s,a){var t=[].concat(s),l=t.length,n=e.font,r=0,o;for(e.font=a.string,o=0;o<l;++o)r=Math.max(e.measureText(t[o]).width,r);return e.font=n,{height:l*a.lineHeight,width:r}},bound:function(e,s,a){return Math.max(e,Math.min(s,a))},arrayDiff:function(e,s){var a=e.slice(),t=[],l,n,r,o;for(l=0,r=s.length;l<r;++l)o=s[l],n=a.indexOf(o),n===-1?t.push([o,1]):a.splice(n,1);for(l=0,r=a.length;l<r;++l)t.push([a[l],-1]);return t},rasterize:function(e){return Math.round(e*Ue)/Ue}};function ve(e,s){var a=s.x,t=s.y;if(a===null)return{x:0,y:-1};if(t===null)return{x:1,y:0};var l=e.x-a,n=e.y-t,r=Math.sqrt(l*l+n*n);return{x:r?l/r:0,y:r?n/r:-1}}function Oa(e,s,a,t,l){switch(l){case"center":a=t=0;break;case"bottom":a=0,t=1;break;case"right":a=1,t=0;break;case"left":a=-1,t=0;break;case"top":a=0,t=-1;break;case"start":a=-a,t=-t;break;case"end":break;default:l*=Math.PI/180,a=Math.cos(l),t=Math.sin(l);break}return{x:e,y:s,vx:a,vy:t}}var Za=0,ea=1,aa=2,ta=4,sa=8;function ne(e,s,a){var t=Za;return e<a.left?t|=ea:e>a.right&&(t|=aa),s<a.top?t|=sa:s>a.bottom&&(t|=ta),t}function Ga(e,s){for(var a=e.x0,t=e.y0,l=e.x1,n=e.y1,r=ne(a,t,s),o=ne(l,n,s),u,d,c;!(!(r|o)||r&o);)u=r||o,u&sa?(d=a+(l-a)*(s.top-t)/(n-t),c=s.top):u&ta?(d=a+(l-a)*(s.bottom-t)/(n-t),c=s.bottom):u&aa?(c=t+(n-t)*(s.right-a)/(l-a),d=s.right):u&ea&&(c=t+(n-t)*(s.left-a)/(l-a),d=s.left),u===r?(a=d,t=c,r=ne(a,t,s)):(l=d,n=c,o=ne(l,n,s));return{x0:a,x1:l,y0:t,y1:n}}function le(e,s){var a=s.anchor,t=e,l,n;return s.clamp&&(t=Ga(t,s.area)),a==="start"?(l=t.x0,n=t.y0):a==="end"?(l=t.x1,n=t.y1):(l=(t.x0+t.x1)/2,n=(t.y0+t.y1)/2),Oa(l,n,e.vx,e.vy,s.align)}var ie={arc:function(e,s){var a=(e.startAngle+e.endAngle)/2,t=Math.cos(a),l=Math.sin(a),n=e.innerRadius,r=e.outerRadius;return le({x0:e.x+t*n,y0:e.y+l*n,x1:e.x+t*r,y1:e.y+l*r,vx:t,vy:l},s)},point:function(e,s){var a=ve(e,s.origin),t=a.x*e.options.radius,l=a.y*e.options.radius;return le({x0:e.x-t,y0:e.y-l,x1:e.x+t,y1:e.y+l,vx:a.x,vy:a.y},s)},bar:function(e,s){var a=ve(e,s.origin),t=e.x,l=e.y,n=0,r=0;return e.horizontal?(t=Math.min(e.x,e.base),n=Math.abs(e.base-e.x)):(l=Math.min(e.y,e.base),r=Math.abs(e.base-e.y)),le({x0:t,y0:l+r,x1:t+n,y1:l,vx:a.x,vy:a.y},s)},fallback:function(e,s){var a=ve(e,s.origin);return le({x0:e.x,y0:e.y,x1:e.x+(e.width||0),y1:e.y+(e.height||0),vx:a.x,vy:a.y},s)}},U=K.rasterize;function Ya(e){var s=e.borderWidth||0,a=e.padding,t=e.size.height,l=e.size.width,n=-l/2,r=-t/2;return{frame:{x:n-a.left-s,y:r-a.top-s,w:l+a.width+s*2,h:t+a.height+s*2},text:{x:n,y:r,w:l,h:t}}}function Xa(e,s){var a=s.chart.getDatasetMeta(s.datasetIndex).vScale;if(!a)return null;if(a.xCenter!==void 0&&a.yCenter!==void 0)return{x:a.xCenter,y:a.yCenter};var t=a.getBasePixel();return e.horizontal?{x:t,y:null}:{x:null,y:t}}function qa(e){return e instanceof Da?ie.arc:e instanceof Qe?ie.point:e instanceof de?ie.bar:ie.fallback}function Ka(e,s,a,t,l,n){var r=Math.PI/2;if(n){var o=Math.min(n,l/2,t/2),u=s+o,d=a+o,c=s+t-o,v=a+l-o;e.moveTo(s,d),u<c&&d<v?(e.arc(u,d,o,-Math.PI,-r),e.arc(c,d,o,-r,0),e.arc(c,v,o,0,r),e.arc(u,v,o,r,Math.PI)):u<c?(e.moveTo(u,a),e.arc(c,d,o,-r,r),e.arc(u,d,o,r,Math.PI+r)):d<v?(e.arc(u,d,o,-Math.PI,0),e.arc(u,v,o,0,Math.PI)):e.arc(u,d,o,-Math.PI,Math.PI),e.closePath(),e.moveTo(s,a)}else e.rect(s,a,t,l)}function Ja(e,s,a){var t=a.backgroundColor,l=a.borderColor,n=a.borderWidth;!t&&(!l||!n)||(e.beginPath(),Ka(e,U(s.x)+n/2,U(s.y)+n/2,U(s.w)-n,U(s.h)-n,a.borderRadius),e.closePath(),t&&(e.fillStyle=t,e.fill()),l&&n&&(e.strokeStyle=l,e.lineWidth=n,e.lineJoin="miter",e.stroke()))}function Qa(e,s,a){var t=a.lineHeight,l=e.w,n=e.x,r=e.y+t/2;return s==="center"?n+=l/2:(s==="end"||s==="right")&&(n+=l),{h:t,w:l,x:n,y:r}}function et(e,s,a){var t=e.shadowBlur,l=a.stroked,n=U(a.x),r=U(a.y),o=U(a.w);l&&e.strokeText(s,n,r,o),a.filled&&(t&&l&&(e.shadowBlur=0),e.fillText(s,n,r,o),t&&l&&(e.shadowBlur=t))}function at(e,s,a,t){var l=t.textAlign,n=t.color,r=!!n,o=t.font,u=s.length,d=t.textStrokeColor,c=t.textStrokeWidth,v=d&&c,w;if(!(!u||!r&&!v))for(a=Qa(a,l,o),e.font=o.string,e.textAlign=l,e.textBaseline="middle",e.shadowBlur=t.textShadowBlur,e.shadowColor=t.textShadowColor,r&&(e.fillStyle=n),v&&(e.lineJoin="round",e.lineWidth=c,e.strokeStyle=d),w=0,u=s.length;w<u;++w)et(e,s[w],{stroked:v,filled:r,w:a.w,x:a.x,y:a.y+a.h*w})}var na=function(e,s,a,t){var l=this;l._config=e,l._index=t,l._model=null,l._rects=null,l._ctx=s,l._el=a};ee(na.prototype,{_modelize:function(e,s,a,t){var l=this,n=l._index,r=wa(S([a.font,{}],t,n)),o=S([a.color,ka.color],t,n);return{align:S([a.align,"center"],t,n),anchor:S([a.anchor,"center"],t,n),area:t.chart.chartArea,backgroundColor:S([a.backgroundColor,null],t,n),borderColor:S([a.borderColor,null],t,n),borderRadius:S([a.borderRadius,0],t,n),borderWidth:S([a.borderWidth,0],t,n),clamp:S([a.clamp,!1],t,n),clip:S([a.clip,!1],t,n),color:o,display:e,font:r,lines:s,offset:S([a.offset,4],t,n),opacity:S([a.opacity,1],t,n),origin:Xa(l._el,t),padding:Ca(S([a.padding,4],t,n)),positioner:qa(l._el),rotation:S([a.rotation,0],t,n)*(Math.PI/180),size:K.textSize(l._ctx,s,r),textAlign:S([a.textAlign,"start"],t,n),textShadowBlur:S([a.textShadowBlur,0],t,n),textShadowColor:S([a.textShadowColor,o],t,n),textStrokeColor:S([a.textStrokeColor,o],t,n),textStrokeWidth:S([a.textStrokeWidth,0],t,n)}},update:function(e){var s=this,a=null,t=null,l=s._index,n=s._config,r,o,u,d=S([n.display,!0],e,l);d&&(r=e.dataset.data[l],o=$a(Je(n.formatter,[r,e]),r),u=q(o)?[]:K.toTextLines(o),u.length&&(a=s._modelize(d,u,n,e),t=Ya(a))),s._model=a,s._rects=t},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(e,s){var a=this,t=e.ctx,l=a._model,n=a._rects,r;this.visible()&&(t.save(),l.clip&&(r=l.area,t.beginPath(),t.rect(r.left,r.top,r.right-r.left,r.bottom-r.top),t.clip()),t.globalAlpha=K.bound(0,l.opacity,1),t.translate(U(s.x),U(s.y)),t.rotate(l.rotation),Ja(t,n.frame,l),at(t,l.lines,n.text,l),t.restore())}});var tt=Number.MIN_SAFE_INTEGER||-9007199254740991,st=Number.MAX_SAFE_INTEGER||9007199254740991;function Y(e,s,a){var t=Math.cos(a),l=Math.sin(a),n=s.x,r=s.y;return{x:n+t*(e.x-n)-l*(e.y-r),y:r+l*(e.x-n)+t*(e.y-r)}}function Le(e,s){var a=st,t=tt,l=s.origin,n,r,o,u,d;for(n=0;n<e.length;++n)r=e[n],o=r.x-l.x,u=r.y-l.y,d=s.vx*o+s.vy*u,a=Math.min(a,d),t=Math.max(t,d);return{min:a,max:t}}function re(e,s){var a=s.x-e.x,t=s.y-e.y,l=Math.sqrt(a*a+t*t);return{vx:(s.x-e.x)/l,vy:(s.y-e.y)/l,origin:e,ln:l}}var la=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};ee(la.prototype,{center:function(){var e=this._rect;return{x:e.x+e.w/2,y:e.y+e.h/2}},update:function(e,s,a){this._rotation=a,this._rect={x:s.x+e.x,y:s.y+e.y,w:s.w,h:s.h}},contains:function(e){var s=this,a=1,t=s._rect;return e=Y(e,s.center(),-s._rotation),!(e.x<t.x-a||e.y<t.y-a||e.x>t.x+t.w+a*2||e.y>t.y+t.h+a*2)},intersects:function(e){var s=this._points(),a=e._points(),t=[re(s[0],s[1]),re(s[0],s[3])],l,n,r;for(this._rotation!==e._rotation&&t.push(re(a[0],a[1]),re(a[0],a[3])),l=0;l<t.length;++l)if(n=Le(s,t[l]),r=Le(a,t[l]),n.max<r.min||r.max<n.min)return!1;return!0},_points:function(){var e=this,s=e._rect,a=e._rotation,t=e.center();return[Y({x:s.x,y:s.y},t,a),Y({x:s.x+s.w,y:s.y},t,a),Y({x:s.x+s.w,y:s.y+s.h},t,a),Y({x:s.x,y:s.y+s.h},t,a)]}});function ia(e,s,a){var t=s.positioner(e,s),l=t.vx,n=t.vy;if(!l&&!n)return{x:t.x,y:t.y};var r=a.w,o=a.h,u=s.rotation,d=Math.abs(r/2*Math.cos(u))+Math.abs(o/2*Math.sin(u)),c=Math.abs(r/2*Math.sin(u))+Math.abs(o/2*Math.cos(u)),v=1/Math.max(Math.abs(l),Math.abs(n));return d*=l*v,c*=n*v,d+=s.offset*l,c+=s.offset*n,{x:t.x+d,y:t.y+c}}function nt(e,s){var a,t,l,n;for(a=e.length-1;a>=0;--a)for(l=e[a].$layout,t=a-1;t>=0&&l._visible;--t)n=e[t].$layout,n._visible&&l._box.intersects(n._box)&&s(l,n);return e}function lt(e){var s,a,t,l,n,r,o;for(s=0,a=e.length;s<a;++s)t=e[s],l=t.$layout,l._visible&&(o=new Proxy(t._el,{get:(u,d)=>u.getProps([d],!0)[d]}),n=t.geometry(),r=ia(o,t.model(),n),l._box.update(r,n,t.rotation()));return nt(e,function(u,d){var c=u._hidable,v=d._hidable;c&&v||v?d._visible=!1:c&&(u._visible=!1)})}var J={prepare:function(e){var s=[],a,t,l,n,r;for(a=0,l=e.length;a<l;++a)for(t=0,n=e[a].length;t<n;++t)r=e[a][t],s.push(r),r.$layout={_box:new la,_hidable:!1,_visible:!0,_set:a,_idx:r._index};return s.sort(function(o,u){var d=o.$layout,c=u.$layout;return d._idx===c._idx?c._set-d._set:c._idx-d._idx}),this.update(s),s},update:function(e){var s=!1,a,t,l,n,r;for(a=0,t=e.length;a<t;++a)l=e[a],n=l.model(),r=l.$layout,r._hidable=n&&n.display==="auto",r._visible=l.visible(),s|=r._hidable;s&&lt(e)},lookup:function(e,s){var a,t;for(a=e.length-1;a>=0;--a)if(t=e[a].$layout,t&&t._visible&&t._box.contains(s))return e[a];return null},draw:function(e,s){var a,t,l,n,r,o;for(a=0,t=s.length;a<t;++a)l=s[a],n=l.$layout,n._visible&&(r=l.geometry(),o=ia(l._el,l.model(),r),n._box.update(o,r,l.rotation()),l.draw(e,o))}},it=function(e){if(q(e))return null;var s=e,a,t,l;if(Sa(e))if(!q(e.label))s=e.label;else if(!q(e.r))s=e.r;else for(s="",a=Object.keys(e),l=0,t=a.length;l<t;++l)s+=(l!==0?", ":"")+a[l]+": "+e[a[l]];return""+s},rt={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:it,labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},E="$datalabels",ra="$default";function ot(e,s){var a=e.datalabels,t={},l=[],n,r;return a===!1?null:(a===!0&&(a={}),s=ee({},[s,a]),n=s.labels||{},r=Object.keys(n),delete s.labels,r.length?r.forEach(function(o){n[o]&&l.push(ee({},[s,n[o],{_key:o}]))}):l.push(s),t=l.reduce(function(o,u){return Ma(u.listeners||{},function(d,c){o[c]=o[c]||{},o[c][u._key||ra]=d}),delete u.listeners,o},{}),{labels:l,listeners:t})}function ye(e,s,a,t){if(s){var l=a.$context,n=a.$groups,r;s[n._set]&&(r=s[n._set][n._key],r&&Je(r,[l,t])===!0&&(e[E]._dirty=!0,a.update(l)))}}function ct(e,s,a,t,l){var n,r;!a&&!t||(a?t?a!==t&&(r=n=!0):r=!0:n=!0,r&&ye(e,s.leave,a,l),n&&ye(e,s.enter,t,l))}function dt(e,s){var a=e[E],t=a._listeners,l,n;if(!(!t.enter&&!t.leave)){if(s.type==="mousemove")n=J.lookup(a._labels,s);else if(s.type!=="mouseout")return;l=a._hovered,a._hovered=n,ct(e,t,l,n,s)}}function ut(e,s){var a=e[E],t=a._listeners.click,l=t&&J.lookup(a._labels,s);l&&ye(e,t,l,s)}var oa={id:"datalabels",defaults:rt,beforeInit:function(e){e[E]={_actives:[]}},beforeUpdate:function(e){var s=e[E];s._listened=!1,s._listeners={},s._datasets=[],s._labels=[]},afterDatasetUpdate:function(e,s,a){var t=s.index,l=e[E],n=l._datasets[t]=[],r=e.isDatasetVisible(t),o=e.data.datasets[t],u=ot(o,a),d=s.meta.data||[],c=e.ctx,v,w,m,x,g,M,C,h;for(c.save(),v=0,m=d.length;v<m;++v)if(C=d[v],C[E]=[],r&&C&&e.getDataVisibility(v)&&!C.skip)for(w=0,x=u.labels.length;w<x;++w)g=u.labels[w],M=g._key,h=new na(g,c,C,v),h.$groups={_set:t,_key:M||ra},h.$context={active:!1,chart:e,dataIndex:v,dataset:o,datasetIndex:t},h.update(h.$context),C[E].push(h),n.push(h);c.restore(),ee(l._listeners,u.listeners,{merger:function(f,R,O){R[f]=R[f]||{},R[f][s.index]=O[f],l._listened=!0}})},afterUpdate:function(e){e[E]._labels=J.prepare(e[E]._datasets)},afterDatasetsDraw:function(e){J.draw(e,e[E]._labels)},beforeEvent:function(e,s){if(e[E]._listened){var a=s.event;switch(a.type){case"mousemove":case"mouseout":dt(e,a);break;case"click":ut(e,a);break}}},afterEvent:function(e){var s=e[E],a=s._actives,t=s._actives=e.getActiveElements(),l=K.arrayDiff(a,t),n,r,o,u,d,c,v;for(n=0,r=l.length;n<r;++n)if(d=l[n],d[1])for(v=d[0].element[E]||[],o=0,u=v.length;o<u;++o)c=v[o],c.$context.active=d[1]===1,c.update(c.$context);(s._dirty||l.length)&&(J.update(s._labels),e.render()),delete s._dirty}};function ca(e,s=null){const a=Ge(),t=A(()=>a.nightMode),l=()=>{var r,o,u,d,c,v,w;const n=t.value;e.value={...e.value,plugins:{...e.value.plugins,datalabels:{...(r=e.value.plugins)==null?void 0:r.datalabels,color:n?"rgba(255, 255, 255, .56)":"#344055"}},scales:{...e.value.scales,y:{...(o=e.value.scales)==null?void 0:o.y,ticks:{...(d=(u=e.value.scales)==null?void 0:u.y)==null?void 0:d.ticks,color:n?"#FFFFFF":"#344055"}},x:{...(c=e.value.scales)==null?void 0:c.x,ticks:{...(w=(v=e.value.scales)==null?void 0:v.x)==null?void 0:w.ticks,color:n?"#FFFFFF":"#344055"}}}},s&&s.value++};return Ye(t,l,{immediate:!0}),{isNightMode:t,updateChartColors:l}}const vt={class:"v-finance__chart styled-section"},_t={class:"v-finance__chart-header"},ft={class:"v-finance__chart-header-wrapper"},ht={class:"v-finance__chart-header-block"},pt={class:"v-finance__chart-pagination"},mt={class:"flex gap-5"},gt={key:0,class:"v-finance__chart-pagination mob"},yt={class:"v-finance__chart-element"},bt={__name:"v-finance-earning",setup(e){we.register(ke,Ce,Qe,de,$e,De,Me,oa);const s=xe(),a=y("По годам"),t=y(0),l=y(!1),n=y(0),r=_=>new Intl.NumberFormat("ru-RU").format(_)+" ₽",o=_=>{const p={month:"long",day:"numeric"};return new Date(_).toLocaleDateString("ru-RU",p)},u=_=>{const p={weekday:"long"},D={day:"numeric"},H=new Date(_).toLocaleDateString("ru-RU",p),N=new Date(_).toLocaleDateString("ru-RU",D);return`${H.charAt(0).toUpperCase()+H.slice(1)}, ${N}`},d=A(()=>{if(a.value==="По месяцам")return c.value;if(a.value==="По неделям"){const _=m.value[n.value];if(_){const p=new Date(_.startDate),D=new Date(_.endDate);return`${o(p)} - ${o(D)}`}return""}else if(a.value==="По дням"){const _=x.value[n.value];if(_){const p=new Date(_.startDate),D=new Date(_.endDate);return`${o(p)} - ${o(D)}`}return""}return null}),c=y(2024),v=y({months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],years:["2024","2025"],weeks:[],days:[]}),w=y({months:[4e4,6e4,4e4,4e4,6e4,6e4,8e4,1e5,8e4,1e5,1e5,1e5],years:[1e5,230400],weeks:[],days:[]}),m=y([{startDate:"2024-04-01",endDate:"2024-04-30",data:[45e3,55e3,6e4,52e3,3e4],labels:["01.04 - 07.04","08.04 - 14.04","15.04 - 21.04","22.04 - 28.04","29.04 - 30.04"]},{startDate:"2024-05-01",endDate:"2024-05-31",data:[48e3,58e3,62e3,54e3,5e4],labels:["01.05 - 07.05","08.05 - 14.05","15.05 - 21.05","22.05 - 28.05","29.05 - 31.05"]}]),x=y([{startDate:"2024-04-08",endDate:"2024-04-14",data:[8e3,12e3,9500,11e3,15e3,8500,7e3],labels:["2024-04-08","2024-04-09","2024-04-10","2024-04-11","2024-04-12","2024-04-13","2024-04-14"]},{startDate:"2024-04-15",endDate:"2024-04-21",data:[9e3,11e3,10500,12e3,14e3,9500,8e3],labels:["2024-04-15","2024-04-16","2024-04-17","2024-04-18","2024-04-19","2024-04-20","2024-04-21"]}]),g=y({labels:v.value.months,datasets:[{label:"Заработок",data:w.value.months,backgroundColor:"#1D4ECC",borderRadius:12,barPercentage:.3,categoryPercentage:.1}]}),M=y({...ze,plugins:{...ze.plugins,datalabels:{color:"#000",anchor:"end",align:"top",offset:0,font:{weight:"bold",size:12},formatter:_=>_?r(_):"",display:_=>_.dataset.data[_.dataIndex]>0}}});ca(M,t);const C=(_,p)=>{const D=[];for(let I=0;I<_.length;I++)_[I]>0&&D.push(I);const H=D.map(I=>_[I]),N=D.map(I=>p[I]);return{data:H,labels:N}};Z(()=>{B(),h()});const h=()=>{try{s.earningData&&f()}catch(_){console.error("Ошибка при получении данных из хранилища:",_)}},f=()=>{B()};Ye(()=>s.lastUpdated,()=>{h(),t.value++});const R=()=>{n.value>0?(n.value--,B()):a.value==="По месяцам"&&c.value>2024&&(c.value--,B())},O=()=>{a.value==="По неделям"&&n.value<m.value.length-1||a.value==="По дням"&&n.value<x.value.length-1?(n.value++,B()):a.value==="По месяцам"&&c.value<2025&&(c.value++,B())},B=()=>{if(a.value==="По неделям"){const _=m.value[n.value];if(!_)return;const p=C(_.data,_.labels);g.value={labels:p.labels,datasets:[{...g.value.datasets[0],data:p.data,barPercentage:.15,categoryPercentage:.4}]}}else if(a.value==="По дням"){const _=x.value[n.value];if(!_)return;const p=C(_.data,_.labels);g.value={labels:p.labels.map(D=>u(D)),datasets:[{...g.value.datasets[0],data:p.data,barPercentage:.3,categoryPercentage:.4}]}}else if(a.value==="По месяцам"){const _=[...w.value.months],p=[...v.value.months],D=C(_,p);g.value={labels:D.labels,datasets:[{...g.value.datasets[0],data:D.data,barPercentage:.4,categoryPercentage:.4}]}}else if(a.value==="По годам"){const _=[...w.value.years],p=[...v.value.years],D=C(_,p);g.value={labels:D.labels,datasets:[{...g.value.datasets[0],data:D.data,barPercentage:.15,categoryPercentage:.8}]}}t.value++},ae=()=>{const _={};if(l.value){const p=g.value.labels.length||v.value.years.length;_["min-width"]=`${p*100}px`,_.width=`${p*100}px`}else if(a.value==="По дням"){const p=g.value.labels.length||7;_["min-width"]=`${Math.max(p*80,500)}px`,_.width="100%"}else if(a.value==="По неделям"){const p=g.value.labels.length||4;_["min-width"]=`${Math.max(p*120,500)}px`,_.width="100%"}return _},te=_=>{switch(a.value=_,n.value=0,l.value=_==="По годам",M.value={...M.value,plugins:{...M.value.plugins,datalabels:{...M.value.plugins.datalabels,display:p=>p.dataset.data[p.dataIndex]>0}},scales:{...M.value.scales,y:{...M.value.scales.y,ticks:{...M.value.scales.y.ticks,padding:15}}}},_){case"По годам":const p=[...w.value.years],D=[...v.value.years],H=C(p,D);g.value={labels:H.labels,datasets:[{...g.value.datasets[0],barPercentage:.15,categoryPercentage:.8,data:H.data}]};break;case"По месяцам":const N=[...w.value.months],I=[...v.value.months],G=C(N,I);g.value={labels:G.labels,datasets:[{...g.value.datasets[0],barPercentage:.4,categoryPercentage:.4,data:G.data}]};break;case"По неделям":case"По дням":B();break}t.value++},se=async()=>{const _=new Date().getFullYear();await va(s.currentRange[0],s.currentRange[1]),await _a(),await fa(_)};return Z(()=>{se()}),(_,p)=>(b(),$("div",vt,[i("div",_t,[i("div",ft,[i("div",ht,[p[0]||(p[0]=i("div",{class:"v-finance__chart-title text-section-title"},"График заработка",-1)),L(i("div",pt,[i("img",{src:He,alt:"",onClick:R,class:"cursor-pointer"}),j(" "+k(d.value)+" ",1),i("img",{src:Ae,alt:"",onClick:O,class:"cursor-pointer"})],512),[[oe,a.value!=="По годам"]]),p[1]||(p[1]=Ee('<div class="v-finance__chart-forecast" data-v-71a4dd38><div class="styled-checkbox" data-v-71a4dd38><input type="checkbox" id="forecast" data-v-71a4dd38><label for="forecast" data-v-71a4dd38></label></div><label for="forecast" data-v-71a4dd38>Уточненный прогноз с учетом отмен</label></div>',1))]),i("div",mt,[P(Q,{items:["По годам","По месяцам","По неделям","По дням"],"onUpdate:modelValue":te}),a.value!=="По годам"?(b(),$("div",gt,[i("img",{src:He,alt:"",onClick:R,class:"cursor-pointer"}),j(" "+k(d.value)+" ",1),i("img",{src:Ae,alt:"",onClick:O,class:"cursor-pointer"})])):V("",!0)])]),p[2]||(p[2]=Ee('<div class="v-finance__chart-forecast mob" data-v-71a4dd38><div class="styled-checkbox" data-v-71a4dd38><input type="checkbox" id="forecast-mob" data-v-71a4dd38><label for="forecast-mob" data-v-71a4dd38></label></div><label for="forecast-mob" data-v-71a4dd38>Уточненный прогноз с учетом отмен</label></div>',1))]),i("div",yt,[i("div",{class:T(["v-finance__chart-wrapper",{year:l.value,weeks:a.value==="По неделям",days:a.value==="По дням"}]),style:qe(ae())},[(b(),W(F(Se),{data:g.value,options:M.value,key:t.value},null,8,["data","options"]))],6)])]))}},xt=Xe(bt,[["__scopeId","data-v-71a4dd38"]]),_e="data:image/svg+xml,%3csvg%20width='56'%20height='56'%20viewBox='0%200%2056%2056'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='28'%20cy='28'%20r='28'%20fill='%23E7FFEB'/%3e%3cg%20clip-path='url(%23clip0_9396_45039)'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M34%2019.7499C33.1716%2019.7499%2032.5%2020.4215%2032.5%2021.2499V34.4999C32.5%2035.3283%2033.1716%2035.9999%2034%2035.9999H35C35.8284%2035.9999%2036.5%2035.3283%2036.5%2034.4999V21.2499C36.5%2020.4215%2035.8284%2019.7499%2035%2019.7499H34ZM26%2024.9999C26%2024.1715%2026.6716%2023.4999%2027.5%2023.4999H28.5C29.3284%2023.4999%2030%2024.1715%2030%2024.9999V34.4999C30%2035.3283%2029.3284%2035.9999%2028.5%2035.9999H27.5C26.6716%2035.9999%2026%2035.3283%2026%2034.4999V24.9999ZM19.5%2028.7499C19.5%2027.9215%2020.1716%2027.2499%2021%2027.2499H22C22.8284%2027.2499%2023.5%2027.9215%2023.5%2028.7499V34.4999C23.5%2035.3283%2022.8284%2035.9999%2022%2035.9999H21C20.1716%2035.9999%2019.5%2035.3283%2019.5%2034.4999V28.7499Z'%20fill='%23258D50'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_9396_45039'%3e%3crect%20width='20'%20height='20'%20fill='white'%20transform='translate(18%2018)'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",fe="data:image/svg+xml,%3csvg%20width='56'%20height='56'%20viewBox='0%200%2056%2056'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='28'%20cy='28'%20r='27.4868'%20stroke='white'%20stroke-opacity='0.08'%20stroke-width='1.0263'/%3e%3cg%20clip-path='url(%23clip0_9463_53783)'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M34%2019.75C33.1716%2019.75%2032.5%2020.4216%2032.5%2021.25V34.5C32.5%2035.3284%2033.1716%2036%2034%2036H35C35.8284%2036%2036.5%2035.3284%2036.5%2034.5V21.25C36.5%2020.4216%2035.8284%2019.75%2035%2019.75H34ZM26%2025C26%2024.1716%2026.6716%2023.5%2027.5%2023.5H28.5C29.3284%2023.5%2030%2024.1716%2030%2025V34.5C30%2035.3284%2029.3284%2036%2028.5%2036H27.5C26.6716%2036%2026%2035.3284%2026%2034.5V25ZM19.5%2028.75C19.5%2027.9216%2020.1716%2027.25%2021%2027.25H22C22.8284%2027.25%2023.5%2027.9216%2023.5%2028.75V34.5C23.5%2035.3284%2022.8284%2036%2022%2036H21C20.1716%2036%2019.5%2035.3284%2019.5%2034.5V28.75Z'%20fill='%23B6EAB5'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_9463_53783'%3e%3crect%20width='20'%20height='20'%20fill='white'%20transform='translate(18%2018)'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",he="data:image/svg+xml,%3csvg%20width='56'%20height='56'%20viewBox='0%200%2056%2056'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='28'%20cy='28'%20r='28'%20fill='%23FFF3F0'/%3e%3cg%20clip-path='url(%23clip0_9438_7847)'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M22%2019.7499C22.8284%2019.7499%2023.5%2020.4215%2023.5%2021.2499V34.4999C23.5%2035.3283%2022.8284%2035.9999%2022%2035.9999H21C20.1716%2035.9999%2019.5%2035.3283%2019.5%2034.4999V21.2499C19.5%2020.4215%2020.1716%2019.7499%2021%2019.7499H22ZM30%2024.9999C30%2024.1715%2029.3284%2023.4999%2028.5%2023.4999H27.5C26.6716%2023.4999%2026%2024.1715%2026%2024.9999V34.4999C26%2035.3283%2026.6716%2035.9999%2027.5%2035.9999H28.5C29.3284%2035.9999%2030%2035.3283%2030%2034.4999V24.9999ZM36.5%2028.7499C36.5%2027.9215%2035.8284%2027.2499%2035%2027.2499H34C33.1716%2027.2499%2032.5%2027.9215%2032.5%2028.7499V34.4999C32.5%2035.3283%2033.1716%2035.9999%2034%2035.9999H35C35.8284%2035.9999%2036.5%2035.3283%2036.5%2034.4999V28.7499Z'%20fill='%23FF3A3A'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_9438_7847'%3e%3crect%20width='20'%20height='20'%20fill='white'%20transform='matrix(-1%200%200%201%2038%2018)'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",pe="data:image/svg+xml,%3csvg%20width='56'%20height='56'%20viewBox='0%200%2056%2056'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='28'%20cy='28'%20r='27.4868'%20stroke='white'%20stroke-opacity='0.08'%20stroke-width='1.0263'/%3e%3cg%20clip-path='url(%23clip0_9463_53810)'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M22%2019.75C22.8284%2019.75%2023.5%2020.4216%2023.5%2021.25V34.5C23.5%2035.3284%2022.8284%2036%2022%2036H21C20.1716%2036%2019.5%2035.3284%2019.5%2034.5V21.25C19.5%2020.4216%2020.1716%2019.75%2021%2019.75H22ZM30%2025C30%2024.1716%2029.3284%2023.5%2028.5%2023.5H27.5C26.6716%2023.5%2026%2024.1716%2026%2025V34.5C26%2035.3284%2026.6716%2036%2027.5%2036H28.5C29.3284%2036%2030%2035.3284%2030%2034.5V25ZM36.5%2028.75C36.5%2027.9216%2035.8284%2027.25%2035%2027.25H34C33.1716%2027.25%2032.5%2027.9216%2032.5%2028.75V34.5C32.5%2035.3284%2033.1716%2036%2034%2036H35C35.8284%2036%2036.5%2035.3284%2036.5%2034.5V28.75Z'%20fill='%23FF7474'/%3e%3c/g%3e%3crect%20x='-0.5'%20y='0.5'%20width='19'%20height='19'%20transform='matrix(-1%200%200%201%2037%2018)'%20stroke='white'%20stroke-opacity='0.08'/%3e%3cdefs%3e%3cclipPath%20id='clip0_9463_53810'%3e%3crect%20width='20'%20height='20'%20transform='matrix(-1%200%200%201%2038%2018)'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",wt={class:"v-compare-chart__wrapper"},kt={class:"v-compare-chart__container"},Ct={class:"tooltip-body"},$t={class:"labels-container"},Dt={class:"label-content"},Ne=100,Mt={__name:"v-compare-chart",props:{comparedChartData:{type:Array,required:!1,default:()=>[]}},setup(e){we.register($e,De,Me,de,ke,Ce);const s=y(null),a=Ge(),t=e,l=A(()=>a.nightMode),n=y(["Прогнозируемое количество занятий","Отмененные занятия","Коэффициент отмен","Упущенная выручка","Ожидаемая выручка"]),r=ha({visible:!1,value:"",x:0,y:0}),o=y({x:0,y:0}),u=m=>{if(!s.value)return;const x=s.value.getBoundingClientRect();o.value.x=m.clientX-x.left,o.value.y=m.clientY-x.top},d=A(()=>t.comparedChartData.length>0),c=m=>{if(!m||m.length<2)return[];const x=[{...m[0],normalizedData:[]},{...m[1],normalizedData:[]}];for(let g=0;g<m[0].data.length;g++){const M=m[0].data[g],C=m[1].data[g],h=Math.max(M,C);h===0?(x[0].normalizedData[g]=0,x[1].normalizedData[g]=0):(x[0].normalizedData[g]=M/h*Ne,x[1].normalizedData[g]=C/h*Ne),x[0].originalData=[...m[0].data],x[1].originalData=[...m[1].data]}return x},v=A(()=>{if(!d.value)return{labels:[],datasets:[]};const m=c(t.comparedChartData),x=[{label:m[0].label,backgroundColor:l.value?"#1F5EFF":"#1D4ECC",data:m[0].normalizedData,barPercentage:.3,categoryPercentage:.5,borderRadius:10,originalData:m[0].originalData},{label:m[1].label,backgroundColor:l.value?"#2D313B":"#CCD8F8",data:m[1].normalizedData,barPercentage:.3,categoryPercentage:.5,borderRadius:10,originalData:m[1].originalData}];return{labels:["","","","",""],datasets:x}}),w={responsive:!0,maintainAspectRatio:!1,plugins:{datalabels:{display:!1},legend:{position:"top",align:"start",labels:{boxWidth:8,usePointStyle:!0,pointStyle:"circle"}},tooltip:{enabled:!1,external:m=>{const x=m.tooltip;if(x.opacity===0){r.visible=!1;return}const g=x.dataPoints[0].datasetIndex,M=x.dataPoints[0].dataIndex,C=v.value.datasets[g].originalData[M];v.value.datasets[g].label,r.value=C,r.x=o.value.x,r.y=o.value.y,r.visible=!0},mode:"nearest",intersect:!0,callbacks:{title:function(m){const x=m[0].dataIndex;return n.value[x]||""},label:function(m){const x=m.dataIndex;return m.dataset.originalData?m.dataset.originalData[x]:m.parsed.y}}}},scales:{y:{display:!1,beginAtZero:!0,grid:{display:!1,drawBorder:!1}},x:{grid:{display:!1,drawBorder:!1},ticks:{display:!1},border:{display:!1}}},layout:{padding:{top:20,right:20,bottom:10,left:20}}};return(m,x)=>d.value?(b(),$("div",{key:0,class:"v-compare-chart",ref_key:"container",ref:s,onMousemove:u},[i("div",wt,[i("div",kt,[P(F(Se),{data:v.value,options:w},null,8,["data"]),P(me,{name:"fade"},{default:z(()=>[r.visible?(b(),$("div",{key:0,class:"custom-tooltip",style:qe({left:r.x+30+"px",top:r.y-20+"px"})},[i("div",Ct,k(r.value),1),x[0]||(x[0]=i("div",{class:"tooltip-arrow"},null,-1))],4)):V("",!0)]),_:1}),i("div",$t,[(b(!0),$(ce,null,be(n.value,(g,M)=>(b(),$("div",{key:M,class:"label-item"},[i("div",Dt,k(g),1)]))),128))])])])],544)):V("",!0)}},St=Xe(Mt,[["__scopeId","data-v-bb9d6417"]]),Pt={class:"v-finance-student styled-section"},Ft={class:"v-finance-student__header"},Vt={class:"v-finance-student__header-block"},It={key:0,class:"v-finance-student__analysis"},Et={class:"v-finance-student__list"},Bt={class:"v-finance-student__list-item finance-analytics-card"},At={class:"finance-analytics-card__info"},Rt={class:"flex gap-3"},Ht={class:"finance-analytics-card__price"},Tt={class:"status green"},zt={class:"v-finance-student__list-item finance-analytics-card"},Ut={class:"finance-analytics-card__info"},Lt={class:"flex gap-3"},Nt={class:"finance-analytics-card__price"},jt={class:"status green"},Wt={class:"v-finance-student__list-item finance-analytics-card"},Ot={class:"finance-analytics-card__info"},Zt={class:"flex gap-3"},Gt={class:"finance-analytics-card__price"},Yt={class:"status green"},Xt={class:"v-finance-student__list"},qt={class:"v-finance-student__list-item finance-analytics-card"},Kt={class:"finance-analytics-card__info"},Jt={class:"flex gap-3"},Qt={class:"finance-analytics-card__price"},es={class:"status red"},as={class:"v-finance-student__list-item finance-analytics-card"},ts={class:"finance-analytics-card__info"},ss={class:"flex gap-3"},ns={class:"finance-analytics-card__price"},ls={class:"status red"},is={class:"v-finance-student__list-item finance-analytics-card"},rs={class:"finance-analytics-card__info"},os={class:"flex gap-3"},cs={class:"finance-analytics-card__price"},ds={class:"status red"},us={key:1,class:"v-finance-student__compare"},vs={class:"v-finance-student__compare-block"},_s={__name:"v-finance-student",setup(e){const s=Pe(),a=A(()=>["Выберите ученика",...s.students]);Z(()=>{s.getStudents()});const t=y(null),l=y(null),n=y(null),r=y(null),o=y({}),u=y(null);y(!1);const d=y(new Date);y(null);const c=A(()=>t.value!=="Выберите ученика"),v=A(()=>{if(t.value){const h=[];return s.students.forEach(f=>{console.log(t.value.id),f.id!=t.value.id&&h.push(f)}),console.log(["Выберите ученика",...h]),["Выберите ученика",...h]}else console.log("mainStudent is not defined");return[]}),w=h=>(console.log(h.toISOString().split("T")[0]),h.toISOString().split("T")[0]),m=async h=>{t.value=h,h.id&&(n.value=await Be(h.id,w(u.value[0]),w(u.value[1]))),l.value&&(l.value="Выберите ученика",r.value.selectSingle("Выберите ученика"))},x=async h=>{if(l.value=h,h.id){const f=await Be(h.id,w(u.value[0]),w(u.value[1]));o.value=[{label:t.value.student_name,data:g(n.value)},{label:h.student_name,data:g(f)}],console.log(o.value)}};function g(h){return[h.total_lessons??0,h.cancelled_count??0,(h.cancelled_ratio??0)*100,h.lost_earnings??0,h.earned_from_lessons??0]}function M({month:h,year:f}){d.value=new Date(f,h,1)}function C(h){if(h==="N/A"||h==null)return"0%";const f=parseFloat(h);return isNaN(f)?"0%":`${f>0?"+":(f<0,"")}${f}%`}return Z(()=>{u.value=Ze()}),(h,f)=>{var R,O,B,ae,te,se,_,p,D,H,N,I,G,Fe,Ve;return b(),$("div",Pt,[i("div",Ft,[i("div",Vt,[f[1]||(f[1]=i("h2",{class:"text-section-title"},"Финансовый анализ ученика",-1)),P(Q,{items:a.value,"onUpdate:modelValue":m},null,8,["items"])]),P(F(Oe),{modelValue:u.value,"onUpdate:modelValue":f[0]||(f[0]=Ie=>u.value=Ie),locale:"ru-RU",clearable:!0,format:F(We),"action-buttons":["cancel","submit"],"cancel-text":"Отмена","select-text":"Выбрать",class:"range custom-datepicker",range:"",onUpdateMonthYear:M},{"clear-icon":z(({clear:Ie})=>f[2]||(f[2]=[])),_:1},8,["modelValue","format"])]),n.value?L((b(),$("div",It,[i("ul",Et,[i("li",Bt,[f[4]||(f[4]=i("div",{class:"finance-analytics-card__img"},[i("img",{class:"day-el",src:_e,alt:""}),i("img",{class:"night-el",src:fe,alt:""})],-1)),i("div",At,[f[3]||(f[3]=i("p",{class:"finance-analytics-card__subtitle"},"Заработано",-1)),i("div",Rt,[i("h4",Ht,k(((O=(R=n.value)==null?void 0:R.earned_from_lessons)==null?void 0:O.toLocaleString("ru-RU"))??"0")+" ₽ ",1),i("div",Tt,k(C((B=n.value)==null?void 0:B.lessons_earnings_percentage_change)),1)])])]),i("li",zt,[f[6]||(f[6]=i("div",{class:"finance-analytics-card__img"},[i("img",{class:"day-el",src:_e,alt:""}),i("img",{class:"night-el",src:fe,alt:""})],-1)),i("div",Ut,[f[5]||(f[5]=i("p",{class:"finance-analytics-card__subtitle"},"Запланировано занятий",-1)),i("div",Lt,[i("h4",Nt,k(((ae=n.value)==null?void 0:ae.total_lessons)??0),1),i("div",jt,k(C((te=n.value)==null?void 0:te.lessons_percentage_change)),1)])])]),i("li",Wt,[f[8]||(f[8]=i("div",{class:"finance-analytics-card__img"},[i("img",{class:"day-el",src:_e,alt:""}),i("img",{class:"night-el",src:fe,alt:""})],-1)),i("div",Ot,[f[7]||(f[7]=i("p",{class:"finance-analytics-card__subtitle"},"LTV",-1)),i("div",Zt,[i("h4",Gt,k(((_=(se=n.value)==null?void 0:se.total_earned)==null?void 0:_.toLocaleString("ru-RU"))??"0")+" ₽ ",1),i("div",Yt,k(C((p=n.value)==null?void 0:p.percentage_change)),1)])])])]),i("ul",Xt,[i("li",qt,[f[10]||(f[10]=i("div",{class:"finance-analytics-card__img"},[i("img",{class:"day-el",src:he,alt:""}),i("img",{class:"night-el",src:pe,alt:""})],-1)),i("div",Kt,[f[9]||(f[9]=i("p",{class:"finance-analytics-card__subtitle"},"Отменённые занятия",-1)),i("div",Jt,[i("h4",Qt,k(((D=n.value)==null?void 0:D.cancelled_count)??0),1),i("div",es,k(C((H=n.value)==null?void 0:H.cancelled_percentage_change)),1)])])]),i("li",as,[f[12]||(f[12]=i("div",{class:"finance-analytics-card__img"},[i("img",{class:"day-el",src:he,alt:""}),i("img",{class:"night-el",src:pe,alt:""})],-1)),i("div",ts,[f[11]||(f[11]=i("p",{class:"finance-analytics-card__subtitle"},"Коэффициент отмен",-1)),i("div",ss,[i("h4",ns,k((((N=n.value)==null?void 0:N.cancelled_ratio)??0)+"%"),1),i("div",ls,k(C((I=n.value)==null?void 0:I.cancelled_ratio_percentage_change)),1)])])]),i("li",is,[f[14]||(f[14]=i("div",{class:"finance-analytics-card__img"},[i("img",{class:"day-el",src:he,alt:""}),i("img",{class:"night-el",src:pe,alt:""})],-1)),i("div",rs,[f[13]||(f[13]=i("p",{class:"finance-analytics-card__subtitle"},"Упущенная выручка",-1)),i("div",os,[i("h4",cs,k(((Fe=(G=n.value)==null?void 0:G.lost_earnings)==null?void 0:Fe.toLocaleString("ru-RU"))??"0")+" ₽ ",1),i("div",ds,k(C((Ve=n.value)==null?void 0:Ve.lost_earnings_percentage_change)),1)])])])])],512)),[[oe,c.value]]):V("",!0),c.value?(b(),$("div",us,[i("div",vs,[f[15]||(f[15]=i("div",{class:"v-finance-student__compare-subtitle"}," Выбрать ученика для сравнительного анализа ",-1)),v.value?(b(),W(Q,{key:0,ref_key:"comapredStudentsSelect",ref:r,items:v.value,"onUpdate:modelValue":x},null,8,["items"])):V("",!0)]),l.value!=="Выберите ученика"?(b(),W(St,{key:0,"compared-chart-data":o.value},null,8,["compared-chart-data"])):V("",!0)])):V("",!0)])}}},fs=["24%","23%","20%","15%","12%","6%"],hs={indexAxis:"y",responsive:!0,maintainAspectRatio:!1,elements:{bar:{borderRadius:10,borderSkipped:!1}},plugins:{legend:{display:!1},tooltip:{enabled:!1},datalabels:{color:Re.transperentBlackText,anchor:"end",align:"end",offset:4,formatter:(e,s)=>{const a=s.dataIndex;return`${fs[a]} (${e.toLocaleString()} ₽)`},font:{weight:500,size:13}}},scales:{x:{max:3e4,grid:{display:!1},ticks:{display:!1},border:{display:!1}},y:{grid:{display:!1},border:{display:!1},ticks:{color:Re.blackText,font:{weight:500,size:13}}}},layout:{padding:{right:100}}},ps={class:"v-finance__analysis styled-section"},ms={class:"v-finance__analysis-header"},gs={class:"v-finance__analysis-nav"},ys=["onClick"],bs={class:"v-finance__analysis-element"},xs={class:"v-finance__analysis-wrapper"},ws={__name:"v-finance-analysis",setup(e){we.register(ke,Ce,de,$e,De,Me,oa);const s=y(0),a=y("earning"),t=y(hs);ca(t,s);const l=y([{name:"Заработок",label:"earning"},{name:"Источник",label:"source"},{name:"Цели",label:"goals"}]),n=d=>{a.value=d},u=y({labels:["Алексей Иванов","Елизавета Иванова","Богдан Иванов","Сергей Иванов","Виолетта Иванова","Даниил Иванов"],datasets:[{label:"Заработок",data:[24e3,23e3,2e4,15e3,12e3,6e3],backgroundColor:"#1D4ECC",borderRadius:10,barPercentage:.3,categoryPercentage:.8}]});return(d,c)=>(b(),$("div",ps,[i("div",ms,[c[0]||(c[0]=i("div",{class:"v-finance__analysis-title text-section-title"},"Анализ учеников",-1)),i("div",gs,[(b(!0),$(ce,null,be(l.value,(v,w)=>(b(),$("div",{key:w,class:T(["styled-nav",{active:a.value===v.label}]),onClick:()=>n(v.label)},k(v.name),11,ys))),128))])]),i("div",bs,[i("div",xs,[(b(),W(F(Se),{data:u.value,options:t.value,key:s.value},null,8,["data","options"]))])])]))}},je="data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M4.66663%2011.3333L11.3333%204.66663M11.3333%204.66663H4.66663M11.3333%204.66663V11.3333'%20stroke='%23545F72'%20stroke-width='1.67'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",ks={class:"v-finance-operations styled-section"},Cs={class:"v-finance-operations__container"},$s={class:"v-finance-operations__header"},Ds={class:"v-finance-operations__list"},Ms={class:"finance-operation__block"},Ss={class:"finance-operation__date caption"},Ps={__name:"v-finance-operation",setup(e){const s=xe(),a=A(()=>s.operations);return Z(()=>{s.fetchFinanceOpeartion()}),(t,l)=>{const n=pa("router-link");return b(),$("div",ks,[i("div",Cs,[i("div",$s,[l[1]||(l[1]=i("h2",{class:"v-finance-operaions-title text-section-title"},"Последние операции",-1)),P(n,{to:{name:"history_operations"},class:"v-finance-operations__link contact-link mob"},{default:z(()=>l[0]||(l[0]=[j(" Открыть историю "),i("img",{src:je,alt:""},null,-1)])),_:1})]),i("ul",Ds,[(b(!0),$(ce,null,be(a.value,r=>(b(),$("li",{class:"v-finance-operations__list-item finance-operation",key:r.id},[i("div",Ms,[l[2]||(l[2]=i("div",{class:"finance-operation__title"},"Алексей Иванов",-1)),i("div",{class:T(["status",F(X)(parseInt(r.amount))])},k(r.amount)+" ₽",3)]),i("span",Ss,k(F(ma)(r.date)),1)]))),128))]),L(i("div",null," У вас нет операций по счёту ",512),[[oe,!a.value.length]]),L(P(n,{to:{name:"history_operations"},class:"v-finance-operations__link contact-link"},{default:z(()=>l[3]||(l[3]=[j(" Открыть историю "),i("img",{src:je,alt:""},null,-1)])),_:1},512),[[oe,a.value.length]])])])}}},Fs={class:"v-income-modal"},Vs={class:"v-income-modal__fields"},Is={key:0,class:"modal-field col"},Es={class:"modal-field row"},Bs={class:"styled-checkbox"},As={class:"modal-field col"},Rs={__name:"v-income-modal",emits:["submit"],setup(e,{emit:s}){const a=Pe(),t=y(null),l=A(()=>a.students),n=y(),r=y(null),o=async()=>{const d={};n.value||(d.student_id=t.value.id),d.sum=r.value,d.comment="string",console.log(d),await ya(d)},u=d=>{t.value=d};return(d,c)=>(b(),W(Ke,{onSubmit:o},{modal:z(()=>[i("div",Fs,[c[6]||(c[6]=i("h1",{class:"modal-title"},"Добавление дохода",-1)),i("div",Vs,[n.value?V("",!0):(b(),$("div",Is,[c[2]||(c[2]=i("p",{class:"modal-subtitle"},"Выбор ученика",-1)),P(Q,{items:l.value,"student-icon":!0,"onUpdate:modelValue":u},null,8,["items"])])),i("div",Es,[i("div",Bs,[L(i("input",{type:"checkbox",id:"not-link","onUpdate:modelValue":c[0]||(c[0]=v=>n.value=v)},null,512),[[ga,n.value]]),c[3]||(c[3]=i("label",{for:"not-link"},null,-1))]),c[4]||(c[4]=i("label",{class:"modal-subtitle",for:"not-link"},"Не привязывать доход к ученику",-1))]),i("div",As,[c[5]||(c[5]=i("label",{class:"modal-subtitle",for:"sum"},"Внесенная сумма (₽)",-1)),L(i("input",{class:"custom-input",type:"number",id:"sum","onUpdate:modelValue":c[1]||(c[1]=v=>r.value=v),placeholder:"Сумма"},null,512),[[ge,r.value]])])])])]),_:1}))}},Hs={class:"v-expense-modal"},Ts={class:"modal-field col"},zs={class:"v-expense-modal__field"},Us={class:"modal-field col"},Ls={__name:"v-expense-modal",props:{studentId:{type:Number,required:!0}},setup(e){const s=Pe(),a=e,t=y({comment:"",sum:null}),l=A(()=>s.currency),n=async()=>{({...t.value,student_id:a.stu})};return(r,o)=>(b(),W(Ke,{onSubmit:n},{modal:z(()=>[i("div",Hs,[o[4]||(o[4]=i("h1",{class:"modal-title"},"Добавление расхода",-1)),i("div",Ts,[o[2]||(o[2]=i("label",{class:"modal-subtitle",for:"sum"},"Сумма",-1)),i("div",zs,[L(i("input",{type:"number",id:"sum",class:"custom-input",placeholder:"Сумма","onUpdate:modelValue":o[0]||(o[0]=u=>t.value.sum=u)},null,512),[[ge,t.value.sum]]),P(Q,{items:l.value},null,8,["items"])])]),i("div",Us,[o[3]||(o[3]=i("label",{class:"modal-subtitle",for:"purpose"},"Назначение",-1)),L(i("input",{class:"custom-input",id:"purpose",type:"text",placeholder:"Назначение","onUpdate:modelValue":o[1]||(o[1]=u=>t.value.comment=u)},null,512),[[ge,t.value.comment]])])])]),_:1}))}},Ns={class:"v-finance"},js={class:"container"},Ws={class:"v-finance__container layout"},Os={class:"v-finance__header"},Zs={class:"v-finance__header-buttons"},Gs={class:"v-finance__block"},Ys={class:"v-finance__left"},Xs={class:"v-finance__right"},qs={class:"v-finance__menu"},sn={__name:"v-finance",setup(e){const s=y(!1),a=y({income:!1,expense:!1}),t=l=>{s.value=!1,a.value[l]=!a.value[l]};return(l,n)=>{const r=xa("click-outside");return b(),$(ce,null,[P(ba,null,{default:z(()=>[i("section",Ns,[i("div",js,[i("div",Ws,[i("div",Os,[n[9]||(n[9]=i("h1",{class:"text-title"},"Финансы",-1)),i("div",Zs,[i("div",{class:"custom-btn white",onClick:n[0]||(n[0]=()=>t("expense"))},n[7]||(n[7]=[i("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M9.99984 4.16663V15.8333M4.1665 9.99996H15.8332",stroke:"white","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),j(" Расход ")])),i("div",{class:"custom-btn blue",onClick:n[1]||(n[1]=()=>t("income"))},n[8]||(n[8]=[i("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M9.99984 4.16663V15.8333M4.1665 9.99996H15.8332",stroke:"white","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),j(" Доход ")]))])]),P(Wa),i("div",Gs,[i("div",Ys,[P(xt),P(ws),P(_s)]),i("div",Xs,[P(Ps)])])])]),L((b(),$("div",qs,[i("button",{class:"v-finance__plus custom-btn blue",onClick:n[2]||(n[2]=o=>s.value=!s.value)},n[10]||(n[10]=[i("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M9.99984 4.16663V15.8333M4.1665 9.99996H15.8332",stroke:"white","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])),i("div",{class:T(["v-finance__menu-items",{active:s.value}])},[i("button",{class:"v-finance__menu-item",onClick:n[3]||(n[3]=()=>t("income"))},n[11]||(n[11]=[i("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M9.99984 4.16663V15.8333M4.1665 9.99996H15.8332",stroke:"#717680","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),j(" Доход ")])),i("button",{class:"v-finance__menu-item",onClick:n[4]||(n[4]=()=>t("expense"))},n[12]||(n[12]=[i("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M9.99984 4.16663V15.8333M4.1665 9.99996H15.8332",stroke:"#717680","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),j(" Расход ")]))],2)])),[[r,()=>s.value=!1]])])]),_:1}),P(me,{name:"fade"},{default:z(()=>[a.value.income?(b(),W(Rs,{key:0,onClose:n[5]||(n[5]=()=>t("income")),class:T({"modal-open":a.value.income})},null,8,["class"])):V("",!0)]),_:1}),P(me,{name:"fade"},{default:z(()=>[a.value.expense?(b(),W(Ls,{key:0,onClose:n[6]||(n[6]=()=>t("expense")),class:T({"modal-open":a.value.expense})},null,8,["class"])):V("",!0)]),_:1})],64)}}};export{sn as default};
