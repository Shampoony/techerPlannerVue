import{r as o,u as I,o as N,a as U,b as r,c as D,d as t,e as d,t as b,f as C,g as m,w as _,n as T,h as v,i as q,T as R,F as L,j as P,k as j}from"./index-DfQYO7_P.js";import{d as w,_ as z,a as H,b as O,c as A,v as G,e as J}from"./v-modals-container-CshQ7KRt.js";import{v as K}from"./v-footer-DhoIXojs.js";import{t as Q,g as W}from"./vue-datepicker-CGJNjsz6.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"v-calendar-day"},Y={class:"wrapper"},Z={class:"v-calendar-day__sec mob-page"},ee={class:"v-calendar-day__sec-container container"},te={class:"v-calendar-day__date"},ae={class:"v-calendar-day__buttons"},se=["onClick"],oe={class:"event-text"},ue={__name:"v-calendar-day",setup(ne){const f=o([]),n=o(),p=o(),y=I("modalsContainer"),x=o(null),g=P(),B=o({cellDuration:60,separators:[{color:"Red",location:new w.DayPilot.Date}]}),i=o({lessons:!1,trial_lesson:!1}),E=s=>{console.log(s),y.value.toggleLessonModals("buttons",s)},c=s=>{i.value[s]=!i.value[s]},k=o(),S=async()=>{const s=await W(n.value),e=[];s.lessons.forEach(a=>{const{start_time:l,end_time:u,...$}=a,h=`${n.value} ${l}`.replace(/(\d{2})\.(\d{2})\.(\d{4})/,"$3-$2-$1T").replace(" ",""),F=`${n.value} ${u}`.replace(/(\d{2})\.(\d{2})\.(\d{4})/,"$3-$2-$1T").replace(" ","");e.push({start:h,end:F,start_time:l.slice(0,5),end_time:u.slice(0,5),...$})}),f.value=e},M=s=>{const[e,a,l]=s.split("."),u=new Date(l,a-1,e);return new Intl.DateTimeFormat("ru-RU",{day:"numeric",month:"long"}).format(u)},V=j();return N(()=>{localStorage.getItem("upd")||(localStorage.setItem("upd",1),V.go(0)),g.query.date&&(n.value=g.query.date,k.value=Q(n.value).split("T")[0],p.value=M(n.value)),S().then(()=>{console.log("events загружены")})}),U(()=>{localStorage.removeItem("upd")}),(s,e)=>(r(),D(L,null,[t("div",X,[t("div",Y,[d(z),t("main",null,[t("section",Z,[t("div",ee,[t("div",{class:"v-calendar-day__back",onClick:e[0]||(e[0]=a=>s.$router.go(-1))},e[5]||(e[5]=[t("img",{src:H,class:"day-el rotate-180",alt:""},null,-1),t("img",{src:O,class:"night-el rotate-180",alt:""},null,-1),t("p",{class:"text-black"},"Назад",-1)])),t("h1",te,b(p.value),1),t("div",ae,[t("div",{class:"v-calendar-day__button trial-btn",onClick:e[1]||(e[1]=a=>c("trial_lesson"))},e[6]||(e[6]=[t("div",{class:"button-plus"},"+",-1),C(" Добавить пробное занятие ")])),t("div",{class:"v-calendar-day__button blue-btn",onClick:e[2]||(e[2]=a=>c("lessons"))},e[7]||(e[7]=[t("div",{class:"button-plus"},"+",-1),C(" Добавить занятие ")]))]),B.value?(r(),m(q(w.DayPilotCalendar),{key:0,startDate:k.value,viewType:"day",locale:"ru-RU",events:f.value,eventBorderRadius:5,timeRangeSelectedHandling:"Disabled",cellDuration:60,height:400,ref_key:"calendarRef",ref:x},{event:_(({event:a})=>[t("div",{class:"event",onClick:l=>E(a.data)},[t("div",{class:T(["event-header",{trial:a.data.trial}])},[t("span",oe,b(a.data.student_name),1)],2),a.data.break.duration?(r(),D("div",{key:0,class:T(["event-header",{break:a.data.break.duration}])},e[8]||(e[8]=[t("span",{class:"event-text"},"Перерыв",-1)]),2)):v("",!0)],8,se)]),_:1},8,["startDate","events"])):v("",!0)])])]),d(K)])]),d(R,{name:"fade"},{default:_(()=>[i.value.lessons?(r(),m(A,{key:0,onClose:e[3]||(e[3]=a=>c("lessons"))})):v("",!0)]),_:1}),d(R,{name:"fade"},{default:_(()=>[i.value.trial_lesson?(r(),m(G,{key:0,onClose:e[4]||(e[4]=a=>c("trial_lesson"))})):v("",!0)]),_:1}),d(J,{ref_key:"modalsContainer",ref:y},null,512)],64))}};export{ue as default};
